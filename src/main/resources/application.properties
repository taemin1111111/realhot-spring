spring.application.name=taeminspring

# ===== 프로파일 설정 =====
# 개발: spring.profiles.active=dev
# 운영: spring.profiles.active=prod
# spring.profiles.active=dev

# DevTools 자동 재시작 비활성화 (완전히 비활성화)
spring.devtools.restart.enabled=false
spring.devtools.livereload.enabled=false
spring.devtools.restart.additional-paths=


# ===== JSP 설정 (WAR 배포용) =====
spring.mvc.view.prefix=/WEB-INF/views/
spring.mvc.view.suffix=.jsp
spring.mvc.view.names=index,test,error,main/*,login/*,adminpage/*,clubmd/*,clubtable/*,hpost/*,mypage/*,notice/*,pullcourse/*

# WAR 배포를 위한 컨텍스트 경로 설정
# WAR 배포시 Tomcat이 파일명(taeminspring)으로 자동 설정하므로 주석 처리
# server.servlet.context-path=/hotplace

# JSP 컴파일러 설정 (Spring Boot 3.x + JAR 배포)
server.jsp-servlet.init-parameters.development=false
server.jsp-servlet.init-parameters.compiler-target-vm=17
server.jsp-servlet.init-parameters.compiler-source-vm=17
server.jsp-servlet.init-parameters.reload-interval=0
server.jsp-servlet.init-parameters.check-interval=0
server.jsp-servlet.init-parameters.keepgenerated=true
server.jsp-servlet.init-parameters.mappedfile=false

# ===== 데이터베이스 설정 (HikariCP 최적화) =====
# 보안 정보는 application-dev.properties 또는 환경변수로 관리
spring.datasource.url=${DB_URL:jdbc:mysql://127.0.0.1:3306/hothot?serverTimezone=Asia/Seoul&characterEncoding=utf8&useSSL=false&allowPublicKeyRetrieval=true&rewriteBatchedStatements=true}
spring.datasource.username=${DB_USERNAME:wherehot_user}
spring.datasource.password=${DB_PASSWORD:S7r!k#9vQp2&bL4xZt^6mNw}
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# HikariCP 성능 최적화 설정
spring.datasource.hikari.maximum-pool-size=50
spring.datasource.hikari.minimum-idle=10
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1200000
spring.datasource.hikari.leak-detection-threshold=60000
spring.datasource.hikari.validation-timeout=3000
spring.datasource.hikari.initialization-fail-timeout=1

# ===== 서버 설정 (성능 최적화) =====
# 포트는 프로파일별 설정에서 관리
server.address=0.0.0.0
# WAR 배포시 context-path는 서버에서 설정
# server.servlet.context-path=/hotplace
server.compression.enabled=true
server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json
server.compression.min-response-size=1024

# Tomcat 최적화 (동시접속 1000명 대응)
server.tomcat.threads.max=500
server.tomcat.threads.min-spare=100
server.tomcat.accept-count=1000
server.tomcat.max-connections=10000
server.tomcat.connection-timeout=20000

# ===== 세션 설정 =====
server.servlet.session.timeout=30m
server.servlet.session.cookie.max-age=1800
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.secure=false

# ===== 인코딩 설정 =====
server.servlet.encoding.charset=UTF-8
server.servlet.encoding.enabled=true
server.servlet.encoding.force=true
server.servlet.encoding.force-request=true
server.servlet.encoding.force-response=true

# ===== 파일 업로드 설정 =====
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=100MB
spring.servlet.multipart.file-size-threshold=2KB
spring.servlet.multipart.resolve-lazily=false
spring.servlet.multipart.location=/tmp

# ===== 정적 리소스 최적화 (JAR 배포용) =====
spring.web.resources.static-locations=classpath:/META-INF/resources/,classpath:/static/,classpath:/public/,classpath:/resources/
spring.web.resources.cache.cachecontrol.max-age=3600
spring.web.resources.cache.cachecontrol.cache-public=true
spring.web.resources.chain.strategy.content.enabled=true
spring.web.resources.chain.strategy.content.paths=/**

# ===== 커스텀 업로드 디렉토리 설정 (JAR 배포용) =====
app.upload.dir=uploads/hpostsave

# ===== 파일 업로드 경로 설정 (JAR 배포용) =====
file.upload.notice-path=uploads/notices
file.upload.place-path=uploads/places
file.upload.md-path=uploads/mdphotos
file.upload.community-path=uploads/community
file.upload.course-path=uploads/course

# ===== 개발 환경 설정 =====
# DevTools 설정은 위에서 이미 정의됨

# ===== 로깅 설정 (JAR 배포용) =====
logging.level.com.wherehot.spring=INFO
logging.level.org.springframework.web=WARN
logging.level.org.springframework.security=WARN
logging.level.com.zaxxer.hikari=WARN
# JAR 배포를 위한 추가 로깅 설정
logging.level.org.springframework.boot.autoconfigure=INFO
logging.level.org.apache.catalina.startup=INFO

# 운영 환경에서는 DEBUG 레벨 비활성화
logging.level.org.springframework.web.servlet.DispatcherServlet=WARN

# ===== 이메일 설정 (Brevo SMTP - model1과 동일) =====
# 보안 정보는 application-dev.properties 또는 환경변수로 관리
spring.mail.host=${EMAIL_HOST:smtp-relay.brevo.com}
spring.mail.port=${EMAIL_PORT:587}
spring.mail.username=${EMAIL_USERNAME:93959a002@smtp-brevo.com}
spring.mail.password=${EMAIL_PASSWORD:gyEmT1QbCR5XjwaN}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.connectiontimeout=5000
spring.mail.properties.mail.smtp.timeout=5000
spring.mail.properties.mail.smtp.writetimeout=5000

# 발신자 정보 (model1과 동일)
spring.mail.from=chotaemin0920@gmail.com
spring.mail.from-name=어디핫?

# ===== MyBatis 설정 =====
mybatis.mapper-locations=classpath:mapper/**/*.xml
mybatis.type-aliases-package=com.wherehot.spring.entity
mybatis.configuration.map-underscore-to-camel-case=true
mybatis.configuration.use-generated-keys=true
mybatis.configuration.default-fetch-size=100
mybatis.configuration.default-statement-timeout=30
mybatis.configuration.cache-enabled=true
mybatis.configuration.lazy-loading-enabled=false
mybatis.configuration.multiple-result-sets-enabled=true

# ===== JWT 설정 (대용량 트래픽 최적화) =====
# 보안 정보는 application-dev.properties 또는 환경변수로 관리
app.jwt.secret=${JWT_SECRET:taeminSecureJwtSecretKey2024SuperLongSecureKeyForProductionEnvironment12345}
# Access Token: 24시간 (86400초) - 사용자 편의성 향상
app.jwt.expiration=86400
# Refresh Token: 30일 (2592000초) - 사용자 편의성
app.jwt.refresh-expiration=2592000

# ===== Redis 설정 =====
# Redis 사용 안함 (개발 환경)
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration

# Redis 사용하려면 아래 주석 해제하고 위의 exclude 라인 주석 처리
# spring.data.redis.host=localhost
# spring.data.redis.port=6379
# spring.data.redis.password=
# spring.data.redis.timeout=2000ms
# spring.data.redis.lettuce.pool.max-active=8
# spring.data.redis.lettuce.pool.max-idle=8
# spring.data.redis.lettuce.pool.min-idle=0

# ===== OAuth2 설정 (네이버) =====
# 보안 정보는 application-dev.properties 또는 환경변수로 관리
spring.security.oauth2.client.registration.naver.client-id=${OAUTH2_NAVER_CLIENT_ID:Uhipu8CFRcKrmTNw5xie}
spring.security.oauth2.client.registration.naver.client-secret=${OAUTH2_NAVER_CLIENT_SECRET:32CliACoQi}
spring.security.oauth2.client.registration.naver.scope=name,email,profile_image
spring.security.oauth2.client.registration.naver.client-name=Naver
spring.security.oauth2.client.registration.naver.authorization-grant-type=authorization_code
spring.security.oauth2.client.registration.naver.redirect-uri=https://wherehotnow.com/oauth2/code/naver

spring.security.oauth2.client.provider.naver.authorization-uri=https://nid.naver.com/oauth2.0/authorize
spring.security.oauth2.client.provider.naver.token-uri=https://nid.naver.com/oauth2.0/token
spring.security.oauth2.client.provider.naver.user-info-uri=https://openapi.naver.com/v1/nid/me
spring.security.oauth2.client.provider.naver.user-name-attribute=response

# ===== 보안 강화 설정 =====
# 세션 쿠키 설정은 위에서 이미 정의됨

# ===== 에러 페이지 설정 =====
server.error.include-stacktrace=never
server.error.include-message=never
server.error.include-binding-errors=never
server.error.include-exception=false
server.error.path=/error
server.error.whitelabel.enabled=false

# ===== JAR 배포를 위한 추가 설정 =====
# Spring Boot JAR 배포 최적화
spring.main.lazy-initialization=false
spring.jmx.enabled=false
spring.output.ansi.enabled=never

# ===== 성능 최적화 설정은 위에서 이미 정의됨 =====