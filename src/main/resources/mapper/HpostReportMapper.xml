<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wherehot.spring.mapper.HpostReportMapper">

    <!-- 신고 저장 -->
    <insert id="insertReport" parameterType="com.wherehot.spring.entity.HpostReport" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO hottalk_report (
            user_id, 
            post_id, 
            reason, 
            content, 
            report_time
        ) VALUES (
            #{userId}, 
            #{postId}, 
            #{reason}, 
            #{content}, 
            #{reportTime}
        )
    </insert>
    
    <!-- 게시글별 신고 목록 조회 -->
    <select id="selectReportsByPostId" resultType="com.wherehot.spring.entity.HpostReport">
        SELECT 
            id,
            user_id as userId,
            post_id as postId,
            reason,
            content,
            report_time as reportTime
        FROM hottalk_report 
        WHERE post_id = #{postId}
        ORDER BY report_time DESC
    </select>
    
    <!-- 사용자별 신고 목록 조회 -->
    <select id="selectReportsByUserId" resultType="com.wherehot.spring.entity.HpostReport">
        SELECT 
            id,
            user_id as userId,
            post_id as postId,
            reason,
            content,
            report_time as reportTime
        FROM hottalk_report 
        WHERE user_id = #{userId}
        ORDER BY report_time DESC
    </select>
    
    <!-- 전체 신고 목록 조회 (관리자용) -->
    <select id="selectAllReports" resultType="com.wherehot.spring.entity.HpostReport">
        SELECT 
            id,
            user_id as userId,
            post_id as postId,
            reason,
            content,
            report_time as reportTime
        FROM hottalk_report 
        ORDER BY report_time DESC
    </select>
    
    <!-- 신고 상세 조회 -->
    <select id="selectReportById" resultType="com.wherehot.spring.entity.HpostReport">
        SELECT 
            id,
            user_id as userId,
            post_id as postId,
            reason,
            content,
            report_time as reportTime
        FROM hottalk_report 
        WHERE id = #{id}
    </select>
    
    <!-- 게시글의 모든 신고 삭제 -->
    <delete id="deleteReportsByPostId">
        DELETE FROM hottalk_report WHERE post_id = #{postId}
    </delete>

</mapper>
