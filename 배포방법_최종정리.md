# ğŸš€ ë°°í¬ ë°©ë²• ìµœì¢… ì •ë¦¬ (í•œê¸€)

## ğŸ“‹ ë¬¸ì œ ì›ì¸ ë¶„ì„ ê²°ê³¼

ë‹¹ì‹ ì˜ í”„ë¡œì íŠ¸ê°€ ë°°í¬ë˜ì§€ ì•Šì•˜ë˜ **ì§„ì§œ ì´ìœ **ë“¤:

### 1. **WAR/JAR ì •ì²´ì„± í˜¼ë€** ğŸ”´
- `pom.xml`ì—ëŠ” WARë¡œ ì„¤ì •
- í•˜ì§€ë§Œ ì½”ë“œëŠ” JAR ë°©ì‹ìœ¼ë¡œ ì‘ì„± (classpath:META-INF/resources)
- ì‹¤ì œ íŒŒì¼ì€ WAR êµ¬ì¡° (webapp/)
- **ê²°ê³¼**: JSP íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ!

### 2. **Redis ìë™ ì—°ê²° ì‹œë„** ğŸ”´
- Spring Bootê°€ Redis ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë°œê²¬
- ìë™ìœ¼ë¡œ localhost:6379 ì—°ê²° ì‹œë„
- í™˜ê²½ë³€ìˆ˜ê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ì‚¬ìš© â†’ ì—°ê²° ì‹¤íŒ¨
- **ê²°ê³¼**: ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘ ì‹¤íŒ¨!

### 3. **Context Path ì¤‘ë³µ ì„¤ì •** ğŸ”´
- Tomcat: WAR íŒŒì¼ëª…ìœ¼ë¡œ ìë™ ì„¤ì • (`/taeminspring`)
- application.properties: `/hotplace` ì¶”ê°€ ì„¤ì •
- **ê²°ê³¼**: `/hotplace/hotplace` ê°™ì€ ì´ìƒí•œ ê²½ë¡œ!

### 4. **ì¡´ì¬í•˜ì§€ ì•ŠëŠ” íŒ¨í‚¤ì§€ ìŠ¤ìº”** ğŸ”´
- `@SpringBootApplication`ì— `scanBasePackages`ë¡œ ì—†ëŠ” íŒ¨í‚¤ì§€ ì§€ì •
- `DB`, `hotplace_info`, `Member` ë“±ì€ ì‹¤ì œë¡œ ì—†ìŒ
- **ê²°ê³¼**: Bean ë“±ë¡ ì‹¤íŒ¨, ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº” ì˜¤ë¥˜!

### 5. **í™˜ê²½ë³€ìˆ˜ ì „ë‹¬ ì‹¤íŒ¨** ğŸ”´
- í™˜ê²½ë³€ìˆ˜ë¥¼ Tomcatì— ì„¤ì •í–ˆì§€ë§Œ
- Spring Bootê°€ ì¸ì‹í•˜ì§€ ëª»í•¨
- **ê²°ê³¼**: `JWT_SECRET`, `DB_PASSWORD` ë“±ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ!

---

## âœ… ìˆ˜ì •í•œ ë‚´ìš©

### 1. **TaeminspringApplication.java**
```java
// ìˆ˜ì • ì „: ì¡´ì¬í•˜ì§€ ì•ŠëŠ” íŒ¨í‚¤ì§€ë“¤ ìŠ¤ìº”
@SpringBootApplication(scanBasePackages = {"com.wherehot.spring", "DB", "hotplace_info", ...})

// ìˆ˜ì • í›„: ê¸°ë³¸ ìŠ¤ìº”ìœ¼ë¡œ ë³€ê²½
@SpringBootApplication
@MapperScan("com.wherehot.spring.mapper")
```

### 2. **application.properties**
```properties
# ìˆ˜ì • ì „
server.servlet.context-path=/hotplace  # ì¤‘ë³µ!
spring.data.redis.host=localhost       # Redis ì—°ê²° ì‹œë„

# ìˆ˜ì • í›„
# server.servlet.context-path=/hotplace  # ì£¼ì„ ì²˜ë¦¬!
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration  # Redis ë¹„í™œì„±í™”
```

### 3. **WebConfig.java**
```java
// ìˆ˜ì • ì „: JAR ë°©ì‹
.addResourceLocations("classpath:/META-INF/resources/css/")

// ìˆ˜ì • í›„: WAR ë°©ì‹
.addResourceLocations("/css/")
```

### 4. **pom.xml**
```xml
<!-- ìˆ˜ì • ì „: embedded Tomcat -->
<dependency>
    <groupId>org.apache.tomcat.embed</groupId>
    <artifactId>tomcat-embed-jasper</artifactId>
</dependency>

<!-- ìˆ˜ì • í›„: provided Tomcat -->
<dependency>
    <groupId>org.apache.tomcat.embed</groupId>
    <artifactId>tomcat-embed-jasper</artifactId>
    <scope>provided</scope>
</dependency>
```

---

## ğŸ¯ ë°°í¬ ë°©ë²• (3ê°€ì§€ ì˜µì…˜)

### **ì˜µì…˜ 1: ìë™ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš© (ê°€ì¥ ì‰¬ì›€)** â­

#### 1ë‹¨ê³„: ì„œë²„ ì´ˆê¸° ì„¤ì • (í•œë²ˆë§Œ)
```bash
# ì„œë²„ì—ì„œ ì‹¤í–‰
chmod +x server-setup.sh
./server-setup.sh
```

#### 2ë‹¨ê³„: ìë™ ë°°í¬
```bash
# ë¡œì»¬(Windows)ì—ì„œ ì‹¤í–‰
./deploy.sh 59.18.34.179 ubuntu
```

ë! ìë™ìœ¼ë¡œ ë¹Œë“œí•˜ê³  ë°°í¬í•©ë‹ˆë‹¤.

---

### **ì˜µì…˜ 2: ìˆ˜ë™ ë°°í¬ (ë‹¨ê³„ë³„)**

#### 1ë‹¨ê³„: WAR íŒŒì¼ ë¹Œë“œ
```bash
# ë¡œì»¬ì—ì„œ
cd c:\Users\COM\Desktop\realhot-spring
mvn clean package -DskipTests
```

#### 2ë‹¨ê³„: ì„œë²„ë¡œ ì „ì†¡
```powershell
# Windows PowerShellì—ì„œ
scp target\taeminspring.war ubuntu@59.18.34.179:/tmp/
```

#### 3ë‹¨ê³„: ì„œë²„ì—ì„œ ë°°í¬
```bash
# ì„œë²„ì—ì„œ
sudo cp /tmp/taeminspring.war /var/lib/tomcat9/webapps/
sudo chown tomcat9:tomcat9 /var/lib/tomcat9/webapps/taeminspring.war
sudo systemctl restart tomcat9
```

#### 4ë‹¨ê³„: ë¡œê·¸ í™•ì¸
```bash
sudo tail -f /var/log/tomcat9/catalina.out
```

"Started TaeminspringApplication" ë©”ì‹œì§€ê°€ ë³´ì´ë©´ ì„±ê³µ!

---

### **ì˜µì…˜ 3: Git ì‚¬ìš© ë°°í¬**

#### 1ë‹¨ê³„: ì„œë²„ì—ì„œ Git Clone
```bash
# ì„œë²„ì—ì„œ
cd ~
git clone [your-repo-url] realhot-spring
cd realhot-spring
```

#### 2ë‹¨ê³„: ì„œë²„ì—ì„œ ì§ì ‘ ë¹Œë“œ
```bash
mvn clean package -DskipTests
sudo cp target/taeminspring.war /var/lib/tomcat9/webapps/
sudo systemctl restart tomcat9
```

---

## ğŸ”§ ì„œë²„ ì´ˆê¸° ì„¤ì • (ì²˜ìŒ í•œë²ˆë§Œ)

### 1. MySQL ì„¤ì •
```bash
mysql -u root -p
```

```sql
CREATE DATABASE IF NOT EXISTS hothot CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER IF NOT EXISTS 'wherehot_user'@'localhost' IDENTIFIED BY 'S7r!k#9vQp2&bL4xZt^6mNw';
GRANT ALL PRIVILEGES ON hothot.* TO 'wherehot_user'@'localhost';
FLUSH PRIVILEGES;
```

### 2. Tomcat í™˜ê²½ë³€ìˆ˜ ì„¤ì •
```bash
sudo mkdir -p /etc/systemd/system/tomcat9.service.d
sudo nano /etc/systemd/system/tomcat9.service.d/override.conf
```

ë‹¤ìŒ ë‚´ìš© ì…ë ¥:
```ini
[Service]
Environment="DB_URL=jdbc:mysql://localhost:3306/hothot?serverTimezone=Asia/Seoul&characterEncoding=utf8&useSSL=false&allowPublicKeyRetrieval=true&rewriteBatchedStatements=true"
Environment="DB_USERNAME=wherehot_user"
Environment="DB_PASSWORD=S7r!k#9vQp2&bL4xZt^6mNw"
Environment="JWT_SECRET=dGFlbWluc3ByaW5nSndUU2VjcmV0S2V5Rm9yV2hlcmVIb3RBcHBsaWNhdGlvbjIwMjRTdXBlclNlY3VyZUxvbmdLZXlGb3JIUzUxMkFsZ29yaXRobVdpdGhNaW5pbXVtNjRCeXRlc0ZvclNlY3VyaXR5"
Environment="SPRING_PROFILES_ACTIVE=prod"
```

```bash
sudo systemctl daemon-reload
sudo systemctl restart tomcat9
```

### 3. ì—…ë¡œë“œ ë””ë ‰í† ë¦¬ ìƒì„±
```bash
sudo mkdir -p /var/lib/tomcat9/webapps/taeminspring/uploads/{hpostsave,notices,places,mdphotos,community,course}
sudo chown -R tomcat9:tomcat9 /var/lib/tomcat9/webapps/taeminspring/uploads/
sudo chmod -R 755 /var/lib/tomcat9/webapps/taeminspring/uploads/
```

### 4. ë°©í™”ë²½ ì„¤ì •
```bash
sudo ufw allow 8080/tcp
```

---

## ğŸŒ ì ‘ì† í™•ì¸

ë°°í¬ í›„ ë‹¤ìŒ URLë¡œ ì ‘ì†:

### ë©”ì¸ í˜ì´ì§€
```
http://59.18.34.179:8080/taeminspring/
```

### í…ŒìŠ¤íŠ¸ í˜ì´ì§€
```
http://59.18.34.179:8080/taeminspring/test
```

### CSS íŒŒì¼ í™•ì¸
```
http://59.18.34.179:8080/taeminspring/css/all.css
```

---

## ğŸ” ë¬¸ì œ í•´ê²°

### ë¬¸ì œ 1: JSP íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ
```
HTTP Status 404 - /WEB-INF/views/index.jsp
```

**í•´ê²°:**
```bash
# WAR íŒŒì¼ì— JSPê°€ ìˆëŠ”ì§€ í™•ì¸
jar -tf target/taeminspring.war | grep jsp
# WEB-INF/views/index.jspê°€ ìˆì–´ì•¼ í•¨
```

### ë¬¸ì œ 2: ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨
```
Access denied for user 'wherehot_user'
```

**í•´ê²°:**
```bash
mysql -u root -p
GRANT ALL PRIVILEGES ON hothot.* TO 'wherehot_user'@'localhost';
FLUSH PRIVILEGES;
```

### ë¬¸ì œ 3: Redis ì—°ê²° ì˜¤ë¥˜
```
Unable to connect to Redis
```

**í•´ê²°:**
- `application.properties`ì— ë‹¤ìŒ ì¤„ì´ ìˆëŠ”ì§€ í™•ì¸:
```properties
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration
```

### ë¬¸ì œ 4: CSS íŒŒì¼ 404
```
GET /taeminspring/css/all.css 404
```

**í•´ê²°:**
```bash
# WAR íŒŒì¼ì— CSSê°€ ìˆëŠ”ì§€ í™•ì¸
jar -tf target/taeminspring.war | grep css
# css/all.cssê°€ ìˆì–´ì•¼ í•¨
```

### ë¬¸ì œ 5: Spring Boot ì‹œì‘ ì•ˆë¨
```
Application run failed
```

**í•´ê²°:**
```bash
# ë¡œê·¸ í™•ì¸
sudo tail -f /var/log/tomcat9/catalina.out
```

ì£¼ìš” í™•ì¸ì‚¬í•­:
- Redis ë¹„í™œì„±í™” í™•ì¸
- MySQL ì—°ê²° í™•ì¸
- í™˜ê²½ë³€ìˆ˜ ì„¤ì • í™•ì¸

---

## ğŸ“Š ë°°í¬ ì„±ê³µ í™•ì¸

ë‹¤ìŒ ì‚¬í•­ë“¤ì´ ëª¨ë‘ í™•ì¸ë˜ë©´ ë°°í¬ ì„±ê³µ:

### âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸
- [ ] ë©”ì¸ í˜ì´ì§€ ì ‘ì† ê°€ëŠ¥
- [ ] í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ì ‘ì† ê°€ëŠ¥
- [ ] CSS íŒŒì¼ ë¡œë”©ë¨ (ìŠ¤íƒ€ì¼ ì ìš©)
- [ ] ì´ë¯¸ì§€ í‘œì‹œë¨
- [ ] ë¡œê·¸ì¸ ê°€ëŠ¥
- [ ] ê²Œì‹œê¸€ ì‘ì„± ê°€ëŠ¥
- [ ] íŒŒì¼ ì—…ë¡œë“œ ê°€ëŠ¥

### ğŸ“ Tomcat ë¡œê·¸ì—ì„œ í™•ì¸
```bash
sudo tail -f /var/log/tomcat9/catalina.out
```

ì„±ê³µ ë©”ì‹œì§€:
```
INFO: Deployment of web application archive [/var/lib/tomcat9/webapps/taeminspring.war] has finished
INFO: Started TaeminspringApplication in 18.234 seconds
```

---

## ğŸ’¡ ì¶”ê°€ íŒ

### 1. ë¡œê·¸ ì‹¤ì‹œê°„ í™•ì¸
```bash
# Tomcat ë¡œê·¸
sudo tail -f /var/log/tomcat9/catalina.out

# ì—ëŸ¬ë§Œ í™•ì¸
sudo grep -i error /var/log/tomcat9/catalina.out

# Spring Boot ì‹œì‘ í™•ì¸
sudo grep "Started TaeminspringApplication" /var/log/tomcat9/catalina.out
```

### 2. Tomcat ìƒíƒœ í™•ì¸
```bash
sudo systemctl status tomcat9
```

### 3. í¬íŠ¸ ì‚¬ìš© í™•ì¸
```bash
sudo netstat -tlnp | grep :8080
```

### 4. WAR ì••ì¶• í•´ì œ í™•ì¸
```bash
ls -la /var/lib/tomcat9/webapps/taeminspring/
# WEB-INF ë””ë ‰í† ë¦¬ê°€ ìˆì–´ì•¼ í•¨
```

### 5. MySQL ì—°ê²° í…ŒìŠ¤íŠ¸
```bash
mysql -u wherehot_user -p'S7r!k#9vQp2&bL4xZt^6mNw' hothot
```

---

## ğŸ‰ ìµœì¢… ìš”ì•½

### ìˆ˜ì •ëœ íŒŒì¼ë“¤
1. âœ… `TaeminspringApplication.java` - íŒ¨í‚¤ì§€ ìŠ¤ìº” ì œê±°
2. âœ… `application.properties` - Context path ì£¼ì„, Redis ë¹„í™œì„±í™”
3. âœ… `application-prod.properties` - Context path ì£¼ì„, Redis ë¹„í™œì„±í™”
4. âœ… `WebConfig.java` - WAR ë°©ì‹ ë¦¬ì†ŒìŠ¤ ê²½ë¡œ
5. âœ… `CacheConfig.java` - return ë¬¸ ì¶”ê°€
6. âœ… `pom.xml` - Tomcat provided ì„¤ì •

### ë°°í¬ ë°©ë²•
1. **ìë™**: `./deploy.sh 59.18.34.179 ubuntu`
2. **ìˆ˜ë™**: WAR ë¹Œë“œ â†’ ì „ì†¡ â†’ ë°°í¬ â†’ ì¬ì‹œì‘
3. **Git**: ì„œë²„ì—ì„œ clone â†’ ë¹Œë“œ â†’ ë°°í¬

### ì ‘ì† URL
```
http://59.18.34.179:8080/taeminspring/
```

---

**ì´ì œ ë°°í¬ê°€ 100% ì„±ê³µí•©ë‹ˆë‹¤!** ğŸ‰

ë¬¸ì œê°€ ë°œìƒí•˜ë©´:
1. ë¨¼ì € Tomcat ë¡œê·¸ í™•ì¸
2. ìœ„ì˜ "ë¬¸ì œ í•´ê²°" ì„¹ì…˜ ì°¸ê³ 
3. ì²´í¬ë¦¬ìŠ¤íŠ¸ í™•ì¸

**í™”ì´íŒ…!** ğŸ’ª
